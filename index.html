<!DOCTYPE html>
<html>
    <head>
        <title>Facebook Login JavaScript Example</title>
        <meta charset="UTF-8">
    </head>
    <body>
        <script>


            /**
             * 
             */
            window.fbAsyncInit = function () {
                FB.init({
                    appId: '677207700926996',
                    cookie: true, // Enable cookies to allow the server to access the session.
                    xfbml: true, // Parse social plugins on this webpage.
                    version: 'v17.0'           // Use this Graph API version for this call.
                });

//                FB.getLoginStatus(function (response) {   // Called after the JS SDK has been initialized.
//                    statusChangeCallback(response);        // Returns the login status.
//                });

                FB.getLoginStatus(statusChangeCallback);

            };



            function statusChangeCallback(response) {  // Called with the results from FB.getLoginStatus().
                console.log('statusChangeCallback');
                console.log(response);                   // The current login status of the person.

                //
                appendTextAreaValue(response);


                if (response.status === 'connected') {   // Logged into your webpage and Facebook.
                    testAPI();
                } else {                                 // Not logged into your webpage or we are unable to tell.
                    document.getElementById('status').innerHTML = 'Please log ' +
                            'into this webpage.';
                }
            }

            /**
             * 給 fb login button 呼叫
             */
            function checkLoginState() {               // Called when a person is finished with the Login Button.
                FB.getLoginStatus(function (response) {   // See the onlogin handler
                    statusChangeCallback(response);
                });
            }


            /*
             * https://developers.facebook.com/docs/facebook-login/web?locale=zh_TW
             */
            function fbLogin() {
                FB.login(statusChangeCallback);
            }

            function fbLogout() {
                FB.logout(function (response) {
                    // Person is now logged out
                });
            }


            function testAPI() {
                // Testing Graph API after login.  See statusChangeCallback() for when this call is made.
                console.log('Welcome!  Fetching your information.... ');


                FB.api('/me?fields=name,email', function (response) {

                    console.log('Successful login for: ' + response.name);

                    console.log(response);

                    document.getElementById('status').innerHTML =
                            'Thanks for logging in, name: ' + response.name + ", email: " + response.email + ", id: " + response.id + '';


                    appendTextAreaValue(response);
                });
            }

            var sn = 0;

            /**
             *              
             */
            function appendTextAreaValue(response) {
                var textArea = document.getElementById('data_textarea');
                textArea.value = "--- " + (++sn) + " ----------------\r\n\r\n" + JSON.stringify(response, null, "\t") + "\r\n\r\n" + textArea.value;
            }


            document.write('<script async defer crossorigin=\"anonymous\" src=\"https://connect.facebook.net/en_US/sdk.js\"><\/script>');

        </script>


        <div id="status">
        </div>


        <!-- The JS SDK Login Button -->

    <fb:login-button scope="public_profile,email" onlogin="checkLoginState();">
    </fb:login-button>



    <div
        class="fb-like"
        data-share="true"
        data-width="450"
        data-show-faces="true">
    </div>



    <input type="button" value="testAPI" onclick="testAPI()">


    <input type="button" value="login" onclick="fbLogin()">


    <textarea id="data_textarea" style="width:100%;height:400px;resize:none;"></textarea>

</body>

</html>

<!-- Load the JS SDK asynchronously -->
<!-- 
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
-->